<!--ヘッター-->
<%= render 'layouts/header' %>
<div class='container mt-5'>
  <div class='row mx-5 mt-5'>
   　<% if current_user.name != "guestuser" %>
    <!--カテゴリ-->
    <%= render "layouts/side", post_categories: @post_categories, question_categories: @question_categories %>
    <div class="col-8 offset-1">
     <div class='row'>
       <div class="col-3">
        <table class='table table-bordered'>
            <tr>
              <td>
                <%= image_tag @user.get_profile_image(200,200),class: "rounded-circle user" %>
             </td>
            </tr>
            <tr>
              <td>
                名前:<%= @user.name %>
              </td>
            </tr>
            <tr>
              <td>
                自己紹介:<%= @user.introduction %>
              </td>
            </tr>
            <tr>
              <td>
                <%= link_to "#{@user.follower.count}フォロー", following_path(current_user, @user),class:"text-dark" %>
              </td>
            </tr>
            <tr>
              <td>
                <%= link_to "#{@user.followed.count}フォロワー", follower_path(current_user, @user),class:"text-dark"%>
              </td>
            </tr>
          </table>

         <div class='row mx-2'>
         <% if @user == current_user %>
            <!--自分-->
            <p>
             <%= link_to "プロフィール編集", edit_user_path(@user),class:"text-success" %>
            </p>
         <% else %>
            <!--他のユーザー-->
            <% if current_user.following?(@user)  %>
            <%= link_to 'フォロー中', user_unfollow_path(current_user, @user), method: :POST %>
            <% else %>
            <%= link_to 'フォローする', user_follow_path(current_user, @user), method: :POST %>
            <% end %>
         <% end %>
         </div>
      　</div>

       <div class="col-9">
          <ul class="row d-flex align-items-center list-unstyled">
             <li class="col-2">
               <%=link_to"投稿一覧",user_path(@user) %>
             </li>
             <li class="col-2">
               <%=link_to"質問一覧",questions_user_path(@user) %>
             </li>
             <li class="col-2">
               <%=link_to"いいね一覧",favorites_user_path(@user) %>
             </li>
          </ul>
          <% if @user.post_images.present? %>
           　<!--ある場合-->
           　<div class="image-warp">
              <% @post_images.each do |post_image| %>
               <div class="index-image px-2">
                  <%= link_to post_image_path(post_image.id) do %>
                    <%= image_tag post_image.get_image(300,300) %>
                  <% end %>
                  <%= link_to(post_image_path(post_image.id), class:"text-dark") do %>
                    <p>
                      <%= post_image.title %>
                    </p>
                  </div>
                  <% end %>
               <% end %>
             </div>
          <% else %>
             <!--ない場合-->
             <p>投稿はありません</p>
          <% end %>
        </div>
    </div>
</div>
  <% else %>
    <% if current_page?(current_user) %>
      <div class="row　justify-content-center">
          <div class='mx-auto col-10 col-sm-10 col-lg-8 col-xl-6 mt-5'>
            <p class="text-center">マイページを使うためにはログアウトをしてから、新規登録/ログインをお願いします。</p>
            <div class="btn-wrapper col-10 mx-auto"></div>
              <div class="row">
                <%= link_to 'ゲストログアウト', destroy_user_session_path, class: "btn btn-secondary btn-sm btn-block mb-3 sign_in", method: :delete %>
              </div>
            </div>
          </div>
        </div>
    <% end %>
    
  <% end %>
    </div>
  </div>
 </div>
</div>
<!--フッター-->
<%= render 'layouts/footer' %>